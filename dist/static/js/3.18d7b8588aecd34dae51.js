webpackJsonp([3],{"15ws":function(t,e){},FwOn:function(t,e){},JPbF:function(t,e){},bjl0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),n=a.n(s),o=a("NYxO"),i=a("5reh"),r=a("woOf"),l=a.n(r),c=a("XrW5"),d=a("i7p3"),m=a("naar"),u=a("zhkS"),h={name:"compCompanyCreateInfo",components:{compInput:c.a,compImgUpload:d.a},props:{orgFile:{type:String,default:""},detailData:{type:Object,default:function(){return{data:[]}}}},data:function(){return{loadingBtn:!1,status:"view",showCover:!1,modify:!0,uploadAction:u._83}},methods:n()({changeUploadStatus:function(){this.status="view",this.modify=!0},nextForm:function(){var t=this;if(this.loadingBtn=!0,Object(m.a)([this.$refs.name,this.$refs.contactor,this.$refs.userMobile,this.$refs.userEmail])){var e={param:{companyId:this.detailData.id,logoFile:this.$refs.logoFile.$refs.upload.fileList.length?this.$refs.logoFile.$refs.upload.fileList[0].file:"",name:this.$refs.name.value,contactor:this.$refs.contactor.value,mobile:this.$refs.userMobile.value,email:this.$refs.userEmail.value,tel:this.$refs.userTel.value},callback:function(a){if(t.loadingBtn=!1,!a)return!1;"1000"===a.data.code?(t.loadingBtn=!1,t.$Message.success("保存成功"),t.$emit("getBaseInfo",e.param)):t.$Message.error("保存失败")}};this.updateCompany(e)}else this.loadingBtn=!1}},Object(o.b)({updateCompany:i._85})),beforeMount:function(){},mounted:function(){},computed:{}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{staticClass:"compCompanyCreateInfo",attrs:{"label-width":90}},[a("FormItem",{staticClass:"title",attrs:{label:"企业信息"}}),a("FormItem",{attrs:{label:"企业LOGO："}},[a("comp-img-upload",{ref:"logoFile",attrs:{status:t.status,name:"upfile",file:t.detailData.logoFile,errorText:"请上传企业LOGO！",tips:"支持jpg、gif、png格式，1M以内，建议尺寸50*50。",uploadAction:t.uploadAction,"on-beforecallback":t.changeUploadStatus,showCover:t.showCover,modify:t.modify}})],1),a("FormItem",{attrs:{label:"企业全称：",required:"required"}},[a("comp-input",{ref:"name",attrs:{name:"name",label:"企业全称",maxLength:64,styles:"width:300px",defaultValue:t.detailData.name}})],1),a("Divider",{attrs:{dashed:"dashed"}}),a("FormItem",{staticClass:"title",attrs:{label:"联系人信息"}}),a("FormItem",{attrs:{label:"联系人：",required:"required"}},[a("comp-input",{ref:"contactor",attrs:{name:"contactor",label:"联系人",styles:"width:300px",defaultValue:t.detailData.contactor}})],1),a("FormItem",{attrs:{label:"手机：",required:"required"}},[a("comp-input",{ref:"userMobile",attrs:{name:"userMobile",label:"手机",validate:"mobile",styles:"width:300px",defaultValue:t.detailData.mobile}})],1),a("FormItem",{attrs:{label:"邮件：",required:"required"}},[a("comp-input",{ref:"userEmail",attrs:{name:"userEmail",label:"邮件",validate:"email",styles:"width:300px",defaultValue:t.detailData.email}})],1),a("FormItem",{attrs:{label:"固话："}},[a("comp-input",{ref:"userTel",attrs:{name:"userTel",label:"固话",styles:"width:300px",defaultValue:t.detailData.tel}})],1),a("FormItem",{attrs:{label:""}},[a("Button",{attrs:{type:"primary",loading:t.loadingBtn},on:{click:t.nextForm}},[t._v("保存")])],1)],1)},staticRenderFns:[]};var p=a("VU/8")(h,f,!1,function(t){a("JPbF")},"data-v-ec72864c",null).exports,v=a("5GVD"),w={name:"compAccountStaffInfo",components:{compInput:c.a,compSelect:v.a},props:{detailData:{type:Object,default:function(){return{data:[]}}},groupData:{type:Array,default:function(){return{data:[]}}}},data:function(){return{loadingBtn:!1,showAddBtn:!1,disabledBtn:!0,showDelBtn:!1,showDelBtn2:!1,showModifyBtn:!0,showMgmtBtn:!0,showMgmtSelect:!1,status:"edit",index:0,formDynamic:{items:[]}}},methods:n()({handleMgmt:function(){this.showMgmtBtn=!1,this.showMgmtSelect=!0},handleCancle:function(t){var e=this.formDynamic.items[t];e.status="view",this.status="view",this.$set(this.formDynamic.items,t,e)},handleSave:function(t,e){var a=this;this.loadingBtn=!0,this.status="view";var s=!0,n="create"===e?"创建":"修改",o=this.$refs["name"+t][0].$refs.input.value,i=this.$refs["select"+t][0].value;if(""===o?(this.$Message.error("请填写分组名称！"),s=!1):""===i&&(this.$Message.error("请选择负责人！"),s=!1),s){var r={param:{manageId:this.$refs["select"+t][0].value,name:this.$refs["name"+t][0].$refs.input.value},callback:function(s){if(a.loadingBtn=!1,!s)return!1;"1000"===s.data.code?(a.showMgmtBtn=!1,a.$Message.success("分组"+n+"成功"),a.$set(a.formDynamic.items,t,{id:"create"===e?s.data.id:a.$refs["groupId"+t][0].value,name:a.$refs["name"+t][0].$refs.input.value,domainCount:0,manageId:a.$refs["select"+t][0].value,manageName:a.$refs["select"+t][0].param.label,manageCode:a.$refs["select"+t][0].param.code,status:"view"})):"100"===s.data.code?a.$Message.error("企业不存在"):"200"===s.data.code?a.$Message.error("分组名称重复"):"300"===s.data.code?a.$Message.error("负责人不存在"):a.$Message.error("分组"+n+"失败")}};"create"===e?(r.param.companyId=this.$refs.companyId.value,this.createGroup(r)):(r.param.groupId=this.$refs["groupId"+t][0].value,this.updateGroup(r))}else this.loadingBtn=!1},handleAdd:function(){this.status="edit",this.showModifyBtn=!1,this.showMgmtBtn=!0,this.showDelBtn=!1,this.formDynamic.items.push({id:0,name:"",domainCount:0,status:"create"})},handleModify:function(t){var e=this.formDynamic.items[t];e.status="modify",this.status="edit",this.showMgmtBtn=!1,this.showMgmtSelect=!0,this.$set(this.formDynamic.items,t,e)},handleRemove:function(t,e){var a=this;if(this.loadingBtn=!0,this.status="view","create"===e)this.showMgmtBtn=!1,this.formDynamic.items.splice(t,1),this.loadingBtn=!1;else{var s={param:{groupId:this.$refs["groupId"+t][0].value},callback:function(e){if(a.loadingBtn=!1,!e)return!1;"1000"===e.data.code?(a.showMgmtBtn=!1,a.$Message.success("删除分组成功"),a.formDynamic.items.splice(t,1)):"100"===e.data.code?a.$Message.error("企业不存在"):"200"===e.data.code?a.$Message.error("分组内有域名，不允许删除"):"300"===e.data.code&&a.$Message.error("用户有分组负责人权限，不允许删除")}};this.deleteGroup(s)}}},Object(o.b)({createGroup:i.j,updateGroup:i._87,deleteGroup:i.m})),beforeMount:function(){},mounted:function(){},computed:n()({},Object(o.d)({usersList:function(t){return this.GLOBALS.CONVERT_SELECT(t.user.users,{label:"userName",value:"id",code:"userCode"})}})),watch:{formDynamic:{handler:function(t,e){1===t.items.length?("edit"===this.status?(this.showDelBtn=!1,this.disabledBtn=!0,this.showDelBtn2=!1):(this.showDelBtn=!1,this.disabledBtn=!1,this.showModifyBtn=!0,this.showMgmtSelect=!1),this.showAddBtn=!0):(this.showDelBtn2=!0,50===t.items.length?this.showAddBtn=!1:this.showAddBtn=!0,"edit"===this.status?(this.showDelBtn=!1,this.showModifyBtn=!1,this.disabledBtn=!0):(this.showDelBtn=!0,this.showModifyBtn=!0,this.disabledBtn=!1,this.showMgmtSelect=!1))},deep:!0},groupData:{handler:function(t,e){this.status="view",this.$set(this.formDynamic,"items",t)},deep:!0}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compCompanyCreateGroup"},[a("input",{ref:"companyId",attrs:{type:"hidden"},domProps:{value:t.detailData.id}}),a("Alert",{attrs:{type:"warning","show-icon":"show-icon"}},[t._v("温馨提示："),a("Icon",{attrs:{slot:"icon",custom:"i-icon i-icon-notice_",size:"16"},slot:"icon"}),a("template",{slot:"desc"},[t._v("每个域名都会关联至企业的分组，用户可为不同分组的域名设置不同的管理人员，实现域名分权管理。")])],2),a("div",{staticClass:"companyName"},[t._v(t._s(t.detailData.name)),a("span",[t._v("( 域名总数："),a("em",[t._v(t._s(t.detailData.domainCount))]),t._v(" 个 )")])]),a("ul",{ref:"group",staticClass:"groupList"},t._l(t.formDynamic.items,function(e,s){return a("li",{key:s,staticClass:"gItem"},[t._m(0,!0),"create"===e.status?a("div",[a("input",{ref:"groupId"+s,refInFor:!0,attrs:{type:"hidden"},domProps:{value:e.id}}),a("comp-input",{ref:"name"+s,refInFor:!0,attrs:{name:"name",label:"请输入组名",maxLength:30,styles:"width:208px"}}),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtBtn,expression:"showMgmtBtn"}],on:{click:t.handleMgmt}},[t._v("+ 添加负责人"),a("Tooltip",{attrs:{placement:"top-end"}},[a("span",{staticStyle:{color:"#fff"},attrs:{slot:"content"},slot:"content"},[t._v("重点保护域名设置解析"),a("br"),t._v("及修改DNS需分组负责人授权。"),a("br"),t._v("重要域名监控消息将通知分组负责人。")]),a("Icon",{attrs:{custom:"i-icon i-icon-tips",size:"16"}})],1)],1),a("compSelect",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtSelect,expression:"showMgmtSelect"}],ref:"select"+s,refInFor:!0,attrs:{styles:"width:150px;",filterable:!0,list:t.usersList,labelInValue:!0}}),a("a",{staticClass:"btnSave",attrs:{href:"javascript:;"},on:{click:function(e){t.handleSave(s,"create")}}},[t._v("保存")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showDelBtn2,expression:"showDelBtn2"}],ref:s,refInFor:!0,staticClass:"btnDel",attrs:{href:"javascript:;"},on:{click:function(e){t.handleRemove(s,"create")}}},[t._v("删除")])],1):t._e(),"modify"===e.status?a("div",[a("input",{ref:"groupId"+s,refInFor:!0,attrs:{type:"hidden"},domProps:{value:e.id}}),a("comp-input",{ref:"name"+s,refInFor:!0,attrs:{name:"name",label:"请输入组名",maxLength:30,styles:"width:208px",defaultValue:e.name}}),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtBtn,expression:"showMgmtBtn"}],on:{click:t.handleMgmt}},[t._v("+ 添加负责人"),a("Tooltip",{attrs:{placement:"top-end"}},[a("span",{staticStyle:{color:"#fff"},attrs:{slot:"content"},slot:"content"},[t._v("重点保护域名设置解析"),a("br"),t._v("及修改DNS需分组负责人授权。"),a("br"),t._v("重要域名监控消息将通知分组负责人。")]),a("Icon",{attrs:{custom:"i-icon i-icon-tips",size:"16"}})],1)],1),a("compSelect",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtSelect,expression:"showMgmtSelect"}],ref:"select"+s,refInFor:!0,attrs:{styles:"width:150px;",filterable:!0,list:t.usersList,defaultValue:e.manageId.toString(),defaultLabel:e.manageName,defaultCode:e.manageCode,labelInValue:!0}}),a("a",{staticClass:"btnSave",attrs:{href:"javascript:;"},on:{click:function(e){t.handleSave(s,"modify")}}},[t._v("保存")]),a("a",{staticClass:"btnCancle",attrs:{href:"javascript:;"},on:{click:function(e){t.handleCancle(s)}}},[t._v("取消")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showDelBtn2,expression:"showDelBtn2"}],ref:s,refInFor:!0,staticClass:"btnDel",attrs:{href:"javascript:;"},on:{click:function(e){t.handleRemove(s,"modify")}}},[t._v("删除")])],1):t._e(),"view"===e.status?a("div",[a("input",{ref:"groupId"+s,refInFor:!0,attrs:{type:"hidden"},domProps:{value:e.id}}),a("div",{staticClass:"groupName"},[a("span",{staticClass:"name"},[t._v(t._s(e.name))]),a("em",{staticClass:"num"},[t._v(t._s(e.domainCount)+"个")])]),a("div",{staticClass:"manager"},[t._v("负责人："+t._s(e.manageName)+"（"+t._s(e.manageCode)+"）"),a("Tooltip",{attrs:{placement:"top-end"}},[a("span",{staticStyle:{color:"#fff"},attrs:{slot:"content"},slot:"content"},[t._v("重点保护域名设置解析"),a("br"),t._v("及修改DNS需分组负责人授权。"),a("br"),t._v("重要域名监控消息将通知分组负责人。")]),a("Icon",{attrs:{custom:"i-icon i-icon-tips",size:"16"}})],1)],1),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showModifyBtn,expression:"showModifyBtn"}],staticClass:"btnModify",attrs:{href:"javascript:;"},on:{click:function(e){t.handleModify(s)}}},[t._v("修改")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showDelBtn,expression:"showDelBtn"}],ref:s,refInFor:!0,staticClass:"btnDel",attrs:{href:"javascript:;"},on:{click:function(e){t.handleRemove(s,"modify")}}},[t._v("删除")])]):t._e()])})),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.showAddBtn,expression:"showAddBtn"}],attrs:{disabled:t.disabledBtn},on:{click:t.handleAdd}},[t._v("+ 添加分组")])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line"},[e("div",{staticClass:"lineT"}),e("div",{staticClass:"lineB"})])}]};var y={components:{compCompanyDetailInfo:p,compCompanyDetailGroup:a("VU/8")(w,g,!1,function(t){a("fO2u")},"data-v-e935184e",null).exports},props:{refresh:{type:Boolean,default:!1},orgFile:{type:String,default:""},detailData:{type:Object,default:function(){return{data:[]}}}},data:function(){return{value:"",loadingBtn:!1,baseInfoData:{},groupData:[]}},methods:{baseInfo:function(t){this.$emit("resetDetailData",t)}},computed:{},beforeMount:function(){},mounted:function(){this.value=this.detailData.tabIdx,this.groupData=this.detailData.groups.map(function(t){return t.status="view",t})},watch:{}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compCompanyCreate"},[a("Tabs",{attrs:{animated:!1},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("TabPane",{staticClass:"tabPane1",attrs:{label:"基本资料",name:"name1"}},[a("comp-company-detail-info",{attrs:{detailData:t.detailData},on:{getBaseInfo:t.baseInfo}})],1),a("TabPane",{staticClass:"tabPane2",attrs:{label:"分组管理",name:"name2"}},[a("comp-company-detail-group",{attrs:{detailData:t.detailData,groupData:t.groupData}})],1)],1)],1)},staticRenderFns:[]};var C={components:{compCompanyDetail:a("VU/8")(y,b,!1,function(t){a("15ws")},"data-v-5e64ca7e",null).exports},name:"compListStyle1",props:{list:{type:Array,default:function(){return{data:[]}}},onShowcompanydetail:{type:Function}},data:function(){return{refresh:!1,drawerCompanyDetail:!1,companyDetailData:{}}},methods:n()({closeDrawer:function(){this.drawerCompanyDetail=!1},drawerChange:function(){this.drawerCompanyDetail?this.refresh=!0:(this.refresh=!1,this.$emit("refreshData"))},resetDetailData:function(t){l()(this.companyDetailData,t),console.log(this.companyDetailData)},showCompanyDetail:function(t,e){var a=this,s={param:{companyId:t},callback:function(t){if(a.loadingBtn=!1,!t)return!1;"1000"===t.data.code?(a.companyDetailData=t.data.data,a.companyDetailData.tabIdx=void 0!==e?e:"name1",a.drawerCompanyDetail=!0):a.$Message.error("企业信息获取失败")}};this.queryCompanyInfo(s)},delCompany:function(t){var e=this;this.$Modal.confirm({title:"确认",content:"<p>请确认是否删除该企业？</p>",loading:!0,onOk:function(){var a={param:{companyId:t},callback:function(t){if(e.$Modal.remove(),!t)return!1;"1000"===t.data.code?(e.$Message.success("企业删除成功"),e.$emit("refreshData")):"100"===t.data.code?e.$Message.error("企业不存在！"):"200"===t.data.code?e.$Message.error("主体公司不允许删除！"):"300"===t.data.code?e.$Message.error("企业下有域名，不允许删除！"):"400"===t.data.code?e.$Message.error("企业下有员工，不允许删除！"):e.$Message.error("企业删除失败！")}};e.deleteCompany(a)},onCancel:function(){}})}},Object(o.b)({deleteCompany:i.l,queryCompanyInfo:i._0})),beforeMount:function(){},mounted:function(){},computed:n()({},Object(o.d)({myUserInfo:function(t){return t.user.myUserInfo},maskClosable:function(t){return t.maskClosable}})),watch:{list:function(t,e){}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("ul",{staticClass:"listStyle1"},t._l(t.list,function(e){return a("li",[a("h3",{staticClass:"clear"},[a("span",{staticClass:"left",domProps:{textContent:t._s(e.type?"下属公司":"主体公司")}}),a("span",{staticClass:"right"},[a("a",{on:{click:function(a){t.showCompanyDetail(e.id)}}},[t._v("修改")]),a("a",{directives:[{name:"show",rawName:"v-show",value:e.type>0,expression:"item.type>0"}],on:{click:function(a){t.delCompany(e.id)}}},[t._v("删除企业")])])]),a("Row",[a("Col",{staticClass:"col1",attrs:{span:"6"}},[a("span",{staticClass:"logo"},[a("img",{attrs:{src:e.logoFile}})])]),a("Col",{staticClass:"col2",attrs:{span:"8"}},[a("strong",{staticClass:"clear"},[t._v(" "+t._s(e.name))]),a("div",{staticClass:"col2Cont"},[a("div",{staticClass:"row1 clear"},[a("span",{staticClass:"left"},[t._v("员工数量："),a("em",[t._v(t._s(e.userCount))]),t._v("个")]),a("router-link",{staticClass:"right",attrs:{to:"/mgmt/accountMgmt"}},[t._v("员工详情")])],1),a("div",{staticClass:"row2 clear"},[a("span",{staticClass:"left"},[t._v("联系人："+t._s(e.contactor))])]),a("div",{staticClass:"row3 clear"},[a("span",{staticClass:"left"},[t._v("手机："+t._s(e.mobile))])]),a("div",{staticClass:"row4 clear"},[a("span",{staticClass:"left"},[t._v("固话："+t._s(e.tel))])]),a("div",{staticClass:"row5 clear"},[a("span",{staticClass:"left"},[t._v("邮箱："+t._s(e.email))])])])]),a("Col",{staticClass:"col3",attrs:{span:"10"}},[a("div",{staticClass:"col3Cont"},[a("div",{staticClass:"row1 clear"},[a("span",{staticClass:"left"},[t._v("域名总数："+t._s(e.domainCount)+" 个")]),a("router-link",{staticClass:"right",attrs:{to:"/domain/mgmt"}},[t._v("域名详情")])],1),e.groups.length?t._l(e.groups,function(e){return a("div",{staticClass:"row2 clear"},[a("span",{staticClass:"left"},[a("i"),t._v(t._s(e.name)+"：")]),a("span",{staticClass:"right"},[t._v(t._s(e.domainCount)+"个")])])}):a("div",{staticClass:"row2 clear"},[a("span",{staticClass:"left"},[t._v("暂无分组")])]),e.groups.length>4?a("div",{staticClass:"row6 clear"},[a("span",{staticClass:"left"},[a("i"),t._v("...")]),a("a",{staticClass:"right",on:{click:function(a){t.showCompanyDetail(e.id,"name2")}}},[t._v("全部分组")])]):t._e()],2)])],1)],1)})),a("Drawer",{attrs:{closable:!0,width:"640",title:"企业详情","mask-closable":t.maskClosable},on:{"on-visible-change":t.drawerChange},model:{value:t.drawerCompanyDetail,callback:function(e){t.drawerCompanyDetail=e},expression:"drawerCompanyDetail"}},[t.refresh?a("comp-company-detail",{attrs:{"on-close":t.closeDrawer,detailData:t.companyDetailData},on:{resetDetailData:t.resetDetailData}}):t._e()],1)],1)},staticRenderFns:[]};var D=a("VU/8")(C,_,!1,function(t){a("l7uF")},"data-v-c522d202",null).exports,B={name:"compCompanyCreateInfo",components:{compInput:c.a,compImgUpload:d.a},props:{orgFile:{type:String,default:""}},data:function(){return{loadingBtn:!1,status:"creat",showCover:!1,modify:!1,uploadAction:u._83}},methods:n()({changeUploadStatus:function(){this.status="view",this.modify=!0},nextForm:function(){var t=this;if(this.loadingBtn=!0,Object(m.a)([this.$refs.name,this.$refs.contactor,this.$refs.userMobile,this.$refs.userEmail])){var e={param:{logoFile:this.$refs.logoFile.$refs.upload.fileList.length?this.$refs.logoFile.$refs.upload.fileList[0].file:"",name:this.$refs.name.value,contactor:this.$refs.contactor.value,mobile:this.$refs.userMobile.value,email:this.$refs.userEmail.value,tel:this.$refs.userTel.value},callback:function(a){if(t.loadingBtn=!1,!a)return!1;"1000"===a.data.code?(t.loadingBtn=!1,t.$Message.success("保存成功"),e.param.companyId=a.data.id,t.$emit("getBaseInfo",e.param)):t.$Message.error("保存失败")}};console.log(e.param),this.createCompany(e)}else this.loadingBtn=!1}},Object(o.b)({createCompany:i.i})),beforeMount:function(){},mounted:function(){},computed:{}},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{staticClass:"compCompanyCreateInfo",attrs:{"label-width":90}},[a("FormItem",{staticClass:"title",attrs:{label:"企业信息"}}),a("FormItem",{attrs:{label:"企业LOGO："}},[a("comp-img-upload",{ref:"logoFile",attrs:{status:t.status,name:"upfile",file:t.orgFile,errorText:"请上传企业LOGO！",tips:"支持jpg、gif、png格式，1M以内，建议尺寸50*50。",uploadAction:t.uploadAction,"on-beforecallback":t.changeUploadStatus,showCover:t.showCover,modify:t.modify}})],1),a("FormItem",{attrs:{label:"企业全称：",required:"required"}},[a("comp-input",{ref:"name",attrs:{name:"name",label:"企业全称",maxLength:64,styles:"width:300px"}})],1),a("Divider",{attrs:{dashed:"dashed"}}),a("FormItem",{staticClass:"title",attrs:{label:"联系人信息"}}),a("FormItem",{attrs:{label:"联系人：",required:"required"}},[a("comp-input",{ref:"contactor",attrs:{name:"contactor",label:"联系人",styles:"width:300px"}})],1),a("FormItem",{attrs:{label:"手机：",required:"required"}},[a("comp-input",{ref:"userMobile",attrs:{name:"userMobile",label:"手机",validate:"mobile",styles:"width:300px"}})],1),a("FormItem",{attrs:{label:"邮件：",required:"required"}},[a("comp-input",{ref:"userEmail",attrs:{name:"userEmail",label:"邮件",validate:"email",styles:"width:300px"}})],1),a("FormItem",{attrs:{label:"固话："}},[a("comp-input",{ref:"userTel",attrs:{name:"userTel",label:"固话",styles:"width:300px"}})],1),a("FormItem",{attrs:{label:""}},[a("Button",{attrs:{type:"primary",loading:t.loadingBtn},on:{click:t.nextForm}},[t._v("保存")])],1)],1)},staticRenderFns:[]};var M=a("VU/8")(B,I,!1,function(t){a("u/nE")},"data-v-16a86d0c",null).exports,$={name:"compAccountStaffInfo",components:{compInput:c.a,compSelect:v.a},props:{baseInfoData:{type:Object,default:function(){return{data:[]}}}},data:function(){return{loadingBtn:!1,showAddBtn:!1,disabledBtn:!0,showDelBtn:!1,showDelBtn2:!1,showModifyBtn:!0,showMgmtBtn:!0,showMgmtSelect:!1,status:"edit",index:0,formDynamic:{items:[]}}},methods:n()({handleMgmt:function(){this.showMgmtBtn=!1,this.showMgmtSelect=!0},handleCancle:function(t){var e=this.formDynamic.items[t];e.status="view",this.status="view",this.$set(this.formDynamic.items,t,e)},handleSave:function(t,e){var a=this;this.loadingBtn=!0,this.status="view";var s=!0,n="create"===e?"创建":"修改",o=this.$refs["name"+t][0].$refs.input.value,i=this.$refs["select"+t][0].value;if(""===o?(this.$Message.error("请填写分组名称！"),s=!1):""===i&&(this.$Message.error("请选择负责人！"),s=!1),s){var r={param:{manageId:this.$refs["select"+t][0].value,name:this.$refs["name"+t][0].$refs.input.value},callback:function(s){if(a.loadingBtn=!1,!s)return!1;"1000"===s.data.code?(a.showMgmtBtn=!1,a.$Message.success("分组"+n+"成功"),a.$set(a.formDynamic.items,t,{id:"create"===e?s.data.id:a.$refs["groupId"+t][0].value,name:a.$refs["name"+t][0].$refs.input.value,domainCount:0,manageId:a.$refs["select"+t][0].value,manage_name:a.$refs["select"+t][0].param.label,manage_code:a.$refs["select"+t][0].param.code,status:"view"})):"100"===s.data.code?a.$Message.error("企业不存在"):"200"===s.data.code?a.$Message.error("分组名称重复"):"300"===s.data.code?a.$Message.error("负责人不存在"):a.$Message.error("分组"+n+"失败")}};"create"===e?(r.param.companyId=this.$refs.companyId.value,this.createGroup(r)):(r.param.groupId=this.$refs["groupId"+t][0].value,this.updateGroup(r))}else this.loadingBtn=!1},handleAdd:function(){this.status="edit",this.showModifyBtn=!1,this.showMgmtBtn=!0,this.showDelBtn=!1,this.formDynamic.items.push({id:0,name:"",domainCount:0,status:"create"})},handleModify:function(t){this.status="edit",this.showMgmtBtn=!1,this.showMgmtSelect=!0,this.$set(this.formDynamic.items[t],"status","modify")},handleRemove:function(t,e){var a=this;if(this.loadingBtn=!0,this.status="view","create"===e)this.showMgmtBtn=!1,this.formDynamic.items.splice(t,1),this.loadingBtn=!1;else{var s={param:{groupId:this.$refs["groupId"+t][0].value},callback:function(e){if(a.loadingBtn=!1,!e)return!1;"1000"===e.data.code?(a.showMgmtBtn=!1,a.$Message.success("删除分组成功"),a.formDynamic.items.splice(t,1)):"100"===e.data.code?a.$Message.error("企业不存在"):"200"===e.data.code?a.$Message.error("分组内有域名，不允许删除"):"300"===e.data.code&&a.$Message.error("用户有分组负责人权限，不允许删除")}};this.deleteGroup(s)}}},Object(o.b)({createGroup:i.j,updateGroup:i._87,deleteGroup:i.m})),beforeMount:function(){},mounted:function(){this.handleAdd()},computed:n()({},Object(o.d)({usersList:function(t){return this.GLOBALS.CONVERT_SELECT(t.user.users,{label:"userName",value:"id",code:"userCode"})}})),watch:{formDynamic:{handler:function(t,e){1===t.items.length?("edit"===this.status?(this.showDelBtn=!1,this.disabledBtn=!0,this.showDelBtn2=!1):(this.showDelBtn=!1,this.disabledBtn=!1,this.showModifyBtn=!0,this.showMgmtSelect=!1),this.showAddBtn=!0):(this.showDelBtn2=!0,50===t.items.length?this.showAddBtn=!1:this.showAddBtn=!0,"edit"===this.status?(this.showDelBtn=!1,this.showModifyBtn=!1,this.disabledBtn=!0):(this.showDelBtn=!0,this.showModifyBtn=!0,this.disabledBtn=!1,this.showMgmtSelect=!1))},deep:!0}}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compCompanyCreateGroup"},[a("input",{ref:"companyId",attrs:{type:"hidden"},domProps:{value:t.baseInfoData.companyId}}),a("Alert",{attrs:{type:"warning","show-icon":"show-icon"}},[t._v("温馨提示："),a("Icon",{attrs:{slot:"icon",custom:"i-icon i-icon-notice_",size:"16"},slot:"icon"}),a("template",{slot:"desc"},[t._v("每个域名都会关联至企业的分组，用户可为不同分组的域名设置不同的管理人员，实现域名分权管理。")])],2),a("div",{staticClass:"companyName"},[t._v(t._s(t.baseInfoData.name)),t._m(0)]),a("ul",{ref:"group",staticClass:"groupList"},t._l(t.formDynamic.items,function(e,s){return a("li",{key:s,staticClass:"gItem"},[t._m(1,!0),"create"===e.status?a("div",[a("input",{ref:"groupId"+s,refInFor:!0,attrs:{type:"hidden"},domProps:{value:e.id}}),a("comp-input",{ref:"name"+s,refInFor:!0,attrs:{name:"name",label:"请输入组名",maxLength:30,styles:"width:208px"}}),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtBtn,expression:"showMgmtBtn"}],on:{click:t.handleMgmt}},[t._v("+ 添加负责人"),a("Tooltip",{attrs:{placement:"top-end"}},[a("span",{staticStyle:{color:"#fff"},attrs:{slot:"content"},slot:"content"},[t._v("重点保护域名设置解析"),a("br"),t._v("及修改DNS需分组负责人授权。"),a("br"),t._v("重要域名监控消息将通知分组负责人。")]),a("Icon",{attrs:{custom:"i-icon i-icon-tips",size:"16"}})],1)],1),a("compSelect",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtSelect,expression:"showMgmtSelect"}],ref:"select"+s,refInFor:!0,attrs:{styles:"width:150px;",filterable:!0,list:t.usersList,labelInValue:!0}}),a("a",{staticClass:"btnSave",attrs:{href:"javascript:;"},on:{click:function(e){t.handleSave(s,"create")}}},[t._v("保存")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showDelBtn2,expression:"showDelBtn2"}],ref:s,refInFor:!0,staticClass:"btnDel",attrs:{href:"javascript:;"},on:{click:function(e){t.handleRemove(s,"create")}}},[t._v("删除")])],1):t._e(),"modify"===e.status?a("div",[a("input",{ref:"groupId"+s,refInFor:!0,attrs:{type:"hidden"},domProps:{value:e.id}}),a("comp-input",{ref:"name"+s,refInFor:!0,attrs:{name:"name",label:"请输入组名",maxLength:30,styles:"width:208px",defaultValue:e.name}}),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtBtn,expression:"showMgmtBtn"}],on:{click:t.handleMgmt}},[t._v("+ 添加负责人"),a("Tooltip",{attrs:{placement:"top-end"}},[a("span",{staticStyle:{color:"#fff"},attrs:{slot:"content"},slot:"content"},[t._v("重点保护域名设置解析"),a("br"),t._v("及修改DNS需分组负责人授权。"),a("br"),t._v("重要域名监控消息将通知分组负责人。")]),a("Icon",{attrs:{custom:"i-icon i-icon-tips",size:"16"}})],1)],1),a("compSelect",{directives:[{name:"show",rawName:"v-show",value:t.showMgmtSelect,expression:"showMgmtSelect"}],ref:"select"+s,refInFor:!0,attrs:{styles:"width:150px;",filterable:!0,list:t.usersList,defaultValue:e.manageId,defaultLabel:e.manage_name,defaultCode:e.manage_code,labelInValue:!0}}),a("a",{staticClass:"btnSave",attrs:{href:"javascript:;"},on:{click:function(e){t.handleSave(s,"modify")}}},[t._v("保存")]),a("a",{staticClass:"btnCancle",attrs:{href:"javascript:;"},on:{click:function(e){t.handleCancle(s)}}},[t._v("取消")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showDelBtn2,expression:"showDelBtn2"}],ref:s,refInFor:!0,staticClass:"btnDel",attrs:{href:"javascript:;"},on:{click:function(e){t.handleRemove(s,"modify")}}},[t._v("删除")])],1):t._e(),"view"===e.status?a("div",[a("input",{ref:"groupId"+s,refInFor:!0,attrs:{type:"hidden"},domProps:{value:e.id}}),a("div",{staticClass:"groupName"},[a("span",{staticClass:"name"},[t._v(t._s(e.name))]),a("em",{staticClass:"num"},[t._v(t._s(e.domainCount)+"个")])]),a("div",{staticClass:"manager"},[t._v("负责人："+t._s(e.manage_name)+"（"+t._s(e.manage_code)+"）"),a("Tooltip",{attrs:{placement:"top-end"}},[a("span",{staticStyle:{color:"#fff"},attrs:{slot:"content"},slot:"content"},[t._v("重点保护域名设置解析"),a("br"),t._v("及修改DNS需分组负责人授权。"),a("br"),t._v("重要域名监控消息将通知分组负责人。")]),a("Icon",{attrs:{custom:"i-icon i-icon-tips",size:"16"}})],1)],1),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showModifyBtn,expression:"showModifyBtn"}],staticClass:"btnModify",attrs:{href:"javascript:;"},on:{click:function(e){t.handleModify(s)}}},[t._v("修改")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showDelBtn,expression:"showDelBtn"}],ref:s,refInFor:!0,staticClass:"btnDel",attrs:{href:"javascript:;"},on:{click:function(e){t.handleRemove(s,"modify")}}},[t._v("删除")])]):t._e()])})),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.showAddBtn,expression:"showAddBtn"}],attrs:{disabled:t.disabledBtn},on:{click:t.handleAdd}},[t._v("+ 添加分组")])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[this._v("( 域名总数："),e("em",[this._v("0")]),this._v(" 个 )")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line"},[e("div",{staticClass:"lineT"}),e("div",{staticClass:"lineB"})])}]};var x={components:{compCompanyCreateInfo:M,compCompanyCreateGroup:a("VU/8")($,F,!1,function(t){a("FwOn")},"data-v-514231b0",null).exports},props:{refresh:{type:Boolean,default:!1}},data:function(){return{value:"",loadingBtn:!1,tabDisabled:!0,baseInfoData:{}}},methods:{baseInfo:function(t){this.tabDisabled=!1,this.value="name2",this.baseInfoData=t}},computed:{},beforeMount:function(){},mounted:function(){},watch:{}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compCompanyCreate"},[a("Tabs",{attrs:{animated:!1},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("TabPane",{staticClass:"tabPane1",attrs:{label:"基本资料",name:"name1"}},[a("comp-company-create-info",{on:{getBaseInfo:t.baseInfo}})],1),a("TabPane",{staticClass:"tabPane2",attrs:{label:"分组管理",name:"name2",disabled:t.tabDisabled}},[a("comp-company-create-group",{attrs:{baseInfoData:t.baseInfoData}})],1)],1)],1)},staticRenderFns:[]};var k={components:{compListStyle1:D,compCompanyCreate:a("VU/8")(x,S,!1,function(t){a("laIE")},null,null).exports},data:function(){return{value:"",refresh:!1,loadingBtn:!1,drawerCompanyCreate:!1,list:[],orgFile:""}},methods:n()({searchListData:function(){this.queryCompanyList(this.queryParam())},closeDrawer:function(){this.drawerCompanyCreate=!1},drawerChange:function(){this.drawerCompanyCreate||this.searchListData()},queryParam:function(){var t=this;return{param:{companyName:this.value},callback:function(e){if(!e)return!1;"1000"===e.data.code?t.list=e.data.data:t.$Message.error("查询失败")}}}},Object(o.b)({queryCompanyList:i._1})),computed:n()({},Object(o.d)({myUserInfo:function(t){return t.user.myUserInfo},maskClosable:function(t){return t.maskClosable}})),beforeMount:function(){this.queryCompanyList(this.queryParam())},watch:{}},L={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contEnterprise"},[a("h1",{staticClass:"pageTitle clear"},[t._v("企业管理"),a("div",{staticClass:"tR"},[a("span",[t._v("搜索")]),a("Input",{ref:"",staticStyle:{width:"200px"},attrs:{placeholder:"企业名称",name:""},model:{value:t.value,callback:function(e){t.value="string"==typeof e?e.trim():e},expression:"value"}}),a("Button",{attrs:{type:"primary",loading:t.loadingBtn},on:{click:t.searchListData}},[t._v("查询")]),a("Button",{on:{click:function(e){t.drawerCompanyCreate=!0}}},[t._v("+ 添加企业")])],1)]),a("div",{staticClass:"secMain"},[a("comp-list-style1",{attrs:{list:t.list},on:{refreshData:t.searchListData}})],1),a("Drawer",{attrs:{closable:!0,width:"640",title:"创建企业","mask-closable":t.maskClosable},on:{"on-visible-change":t.drawerChange},model:{value:t.drawerCompanyCreate,callback:function(e){t.drawerCompanyCreate=e},expression:"drawerCompanyCreate"}},[t.drawerCompanyCreate?a("comp-company-create",{attrs:{"on-close":t.closeDrawer,orgFile:t.orgFile}}):t._e()],1)],1)},staticRenderFns:[]};var N=a("VU/8")(k,L,!1,function(t){a("gqbG")},"data-v-3a0b1494",null);e.default=N.exports},fO2u:function(t,e){},gqbG:function(t,e){},l7uF:function(t,e){},laIE:function(t,e){},"u/nE":function(t,e){}});
//# sourceMappingURL=3.18d7b8588aecd34dae51.js.map